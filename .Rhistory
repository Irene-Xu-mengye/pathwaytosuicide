NumPrep_Total + Pthwy_mean),
ifelse(!is.na(TotalPthwy_Max),
TotalPthwy_Max * 0.5 + Pthwy_mean,
Pthwy_mean)))
cal_func <- function(x, y) {
m1 <- lm(y ~ x, data_new)
summary(m1)
}
at <- c("2","4","9","10","12","13","14","15","27","28","33","35","41","43","44","45","46","48","50","52","57","59","61","62","63","64","65","66","68","103", "105")
ab <- c("5","6","7","39","11","16","19","21","22","24","25","29","30","31","35","37","38","39","42","49","56","60")
int <- c("1","55")
abint <- c("5","6","7","39","11","16","19","21","22","24","25","29","30","31","35","37","38","39","42","49","56","60","1","55")
female <- c("2","4","5","6","7","8","9","11","12","13","17","19","21","22","23","24","25","27","28","31","34","36","37","38","40","41","43","44","45", "48", "49","50","53","54","58","59","64","65","69")
data_combinedBins <- data_totalPthwy %>%
mutate(think_mull_decide = ThoughtsStart_bin + Mull_bin + Decision_bin,
first_sure_method = FstMethod_bin + SureMethod_bin,
first_sure_place = FstPlace_bin + SurePlace_bin,
decide_method_place = Decision_bin + SureMethod_bin + SurePlace_bin,
all_bins = think_mull_decide + first_sure_method + first_sure_place)
data_new <- data_combinedBins %>%
mutate(group = as.factor(ifelse(Subject %in% at, "at", ifelse(Subject %in% abint, "ab/int", NA))),
sex = as.factor(ifelse(Subject %in% female, "F", "M")),
whether_planned_f = as.factor(X1.2_Ever_made_a_plan),
whether_mulled_f = as.factor(X8.3_Mulled_for_this_attempt),
dpr_f = as.factor(dpr_2_wk),
X2.6_Confirm_suicide_intent = ifelse(X2.6_Confirm_suicide_intent == 3, 2, X2.6_Confirm_suicide_intent),
suicide_intent_f = as.factor(X2.6_Confirm_suicide_intent),
sis_1 = SIS_15_HowMuchPlan,
sis_2 = sis_1 + SIS_6_Planning,
sis_3 = sis_2 + SIS_7_WriteAnything,
sis_7 = SIS_1_AnyoneNearby+SIS_2_HowLikelyDiscovery+SIS_3_AvoidDiscovery+SIS_5_Preparations,
sis_8 = sis_7 + SIS_8_WhoDidYouTell,
sis_15 = SIS_1_AnyoneNearby+SIS_2_HowLikelyDiscovery+SIS_3_AvoidDiscovery+SIS_4_ContactHelper+SIS_5_Preparations+SIS_6_Planning+SIS_7_WriteAnything+SIS_8_WhoDidYouTell+SIS_9_Why+SIS_10_ThinkDie+SIS_11_ConfidenceDeath+SIS_12_HowSerious+SIS_13_HowCertainWantDie+SIS_14_CouldDoctorHelp+SIS_15_HowMuchPlan,
pthwy_thoughts_amt = TotalpthwyMean*thoughts_amt,
pthwy_thoughts_push = TotalpthwyMean*thoughts_want,
pthwy_thoughts_pull = TotalpthwyMean*thoughts_not_want,
pthwy_thoughts_counbal = TotalpthwyMean*thoughts_score,
perceived_lethality = ifelse(as.character(X12.17_Method_Perceived_Lethality) == "4- dehydration", "4", as.character(X12.17_Method_Perceived_Lethality)),
perceived_lethality = as.numeric(perceived_lethality),
nssi_duration = Age-X2.2_NSSI_Age_FirstTime,
nssi_onset = X2.2_NSSI_Age_FirstTime,
nssi_times = as.double(ifelse(X2.2_NSSI_NumTimes_FINAL == "25-50", "37.5",
ifelse(X2.2_NSSI_NumTimes_FINAL == "50-75", "62.5",
ifelse(X2.2_NSSI_NumTimes_FINAL == "5-10", "7.5",
ifelse(X2.2_NSSI_NumTimes_FINAL == "1-5", "2.5",
ifelse(X2.2_NSSI_NumTimes_FINAL == "11-25", "18",
ifelse(X2.2_NSSI_NumTimes_FINAL == "50-100", "75",
ifelse(X2.2_NSSI_NumTimes_FINAL == "1", "1", NA)))))))),
nssi_freq = nssi_times/ifelse(nssi_duration == 0, NA, nssi_duration),
aborted_onset = X2.4_Aborted_First_Age,
aborted_duration = X2.4_Aborted_Recent_ageFinal - aborted_onset,
aborted_freq = X2.4_Aborted_Num_Times_FINAL/ifelse(aborted_duration == 0, NA, aborted_duration),
realize_not_dead = ifelse(X12.16_Realized_Not_Dead == "4- physical relief 3- partly upset for not completing", "3.5",
ifelse(X12.16_Realized_Not_Dead == "3-anxious", "3",
ifelse(X12.16_Realized_Not_Dead == "2->4 (cluster)","3",
ifelse(X12.16_Realized_Not_Dead == "pretty disappointed", "4", as.character(X12.16_Realized_Not_Dead))))),
realize_not_dead = as.numeric(realize_not_dead),
first_int_age = ifelse(!is.na(X2.5_Interrupted_Age_First), X2.5_Interrupted_Age_First, X2.5_Age_RecentorSingle),
first_action_age = X2.6_First_AT_age,
first_action_age = ifelse(is.na(first_action_age), first_int_age, first_action_age),
first_action_age = ifelse(is.na(first_action_age), X2.4_Aborted_First_Age, ifelse(first_action_age<=X2.4_Aborted_First_Age, first_action_age, X2.4_Aborted_First_Age)),
ideation_onset = X2.9.1_Age_FirstTime_Should_Kill,
at_duration = X2.6_RecentorSingle_AT_age - X2.6_First_AT_age,
FirstID_to_FirstAction = first_action_age - X2.9.1_Age_FirstTime_Should_Kill
) %>%
select(-X2.5_Interrupted_NumTimes_Notes,-X5.1_FirstTime_ThoughtofMethod,-X5.2_First_Thoughtof_Method_for_this_attempt,-X5.3_Time_SureofMethod,-First_think_of_method_1_for_this_attempt,-First_think_of_method_1_for_this_attempt_Unit,-Interrupt.Abort_FirstTime_ThoughtofAnyMethodEver....,-Sure_of_Method,-Sure_of_Method_Unit,-X6.2_when_first_thoughtof_place,-X6.2_when_first_thoughtof_place_Unit,-X6.3_First_thinkof_place_for_this_attempt,-X6.4_First_time_sure_place_for_this_attempt,-X6.3_First_thinkof_place_for_this_attempt_Unit,-FirstTime_sureof_place_for_This_Attempt,-FirstTime_sureof_place_for_This_Attempt_Unit,-X6.7_Suicide_Intent_When,-X6.8_Travel_HowLong,-X7_Time,-X7.2_When_decided_the_time,-X7.3_How_sure_about_planned_time,-X8.1_Think_about_for_this_attempt,-Mulled_for_how_long_beforeAttempt_OR_atTheMostRecentMulling,-Mulled_for_how_long_beforeAttempt_OR_atTheMostRecentMulling_Unit,-Start_thinking_about_this_attempt,-Start_thinking.about_this_attempt_Time,-Start_thinking.about_this_attempt_Time_Unit,-X8.4_Start_mulling_for_this_attempt,-most_recent_mulling_to_interview,-most_recent_mulling_to_interview_Unit,-X8.8_When_Decision,-X12.16_Realized_Not_Dead,-X12.17_Method_Perceived_Lethality,-X2.2_NSSI_NumTimes_FINAL,-Dep_2_weeks)
write_csv(data_new, "./Data/SecondStep_most_up_to_date.csv")
data <-  read.csv(file = "./Data/FirstStep_most_up_to_date.csv")
View(data)
View(data)
data <- read.csv(file = "./Data/SecondStep_most_up_to_date.csv")
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
d_abint <- data %>%
filter(group == "ab/int")
#%>%  mutate(at_lethality = mean(X12.18_Injuries_LethalityScale, na.rm = TRUE))
d_at <- data %>%
filter(group == "at")
View(d_abint)
library(tidyverse)
library(Hmisc)
library(corrplot)
data <-  read.csv(file = "./Data/FirstStep_most_up_to_date.csv")
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
data <- data %>%
select(-x.axis_Value_Orig, -Unit, -Interview_Date, -IST_sub, -IST_MeanAccuracy, -IST_Mean_num_boxes_opened, -IST_MeanTrialAmount, -IST_TotalAmount, -IST_MeanDecisionTimeperPress, -IST_MeanDecisionTime, -IST_Mean_PCorrChanges, -IST_Mean_AverageAmountWons, -IST_Mean_AvgAmountRatios, -IST_Mean_AvgAmountMajChanges, -IST_Mean_AvgAmountMinChanges, -IST_FreeBlockMeanAccuracy, -IST_FreeBlockMean_num_boxes_opened, -IST_FreeBlockMeanTrialAmount, -IST_FreeBlockTotalAmount, -IST_FreeBlockMeanDecisionTimeperPress, -IST_FreeBlockMeanDecisionTime, -IST_FreeBlockMean_PCorrChanges, -IST_Mean_pCorrs, -IST_FreeBlockMean_AverageAmountWons, -IST_FreeBlockMean_AvgAmountRatios, -IST_FreeBlockMean_AvgAmountMajChanges, -IST_FreeBlockMean_AvgAmountMinChanges, -IST_CostBlockMeanAccuracy, -IST_CostBlockMean_num_boxes_opened, -IST_CostBlockMeanTrialAmount, -IST_CostBlockTotalAmount, -IST_CostBlockMeanDecisionTimeperPress, -IST_CostBlockMeanDecisionTime, -IST_CostBlockMean_PCorrChanges, -IST_CostBlockMean_AverageAmountWons, -IST_CostBlockMean_AvgAmountRatios, -IST_CostBlockMean_AvgAmountMajChanges, -IST_CostBlockMean_AvgAmountMinChanges, -CPTGNG_sub, -CPTGNG_hit_meanRT, -CPTGNG_RT_Pre_CommissionError, -CPTGNG_RT_Pre_OmmissionError, -CPTGNG_RT_Pre_CorrectTrials, -CPTGNG_RT_Post_CommissionError, -CPTGNG_RT_Post_Correct, -CPTGNG_c_bias_All, -CPTGNG_c_bias_norm_All, -CPTGNG_hits, -CPTGNG_corr_rej, -CPTGNG_OverallAccuracy, -CPTGNG_hitRate, -CPTGNG_miss_omissionErrorRate, -CPTGNG_correct_rej_Rate, -CPTGNG_falsealarm_commissionErrorRate, -CPTGNG_hit_meanSTD, -CPTGNG_FA_commissionRT, -CPTGNG_FA_commissionSTD, -CPTGNG_TotalRT, -CPTGNG_TotalRT_STD, -MDQ_sub, -MDQ_k, -MDQ_k_log10, -MDQ_MeanRT, -MDQ_FitK_k, -MDQ_Lau_k, -MDQ_FitK_m, -MDQ_FitK_LL, -SSRT_subj, -SSRT_nsort, -SSRT_nsocorrect, -SSRT_nsoincorrect, -SSRT_nsomissed, -SSRT_sopresp, -SSRT_sossd, -SSRT_sossrtMean, -SSRT_sossrtIntbyBlock, -Q_sub, -X1.1_Ever_thought_about, -X1.3_Ever_Made_An_Attempt, -X2.1_Thought_Disappear, -X2.2_Thoughts_Never_Born, -X2.3_Thoughts_Not_Worth_Living, -X2.4_Thoughts_Wish_Dead, -X2.5_Thoughts_Maybe.Should_KillSelf, -X2.6_Thoughts_Should.KillSelf, -X2.7_First_Thought, -X2.8_Age_first_had_2.7, -X2.10_Should_Kill_Age_Accuracy, -X2.2_Ever_NSSI, -X2.2_NSSI_Age_Recent, -X2.2_NSSI_MethodsCoded, -X2.3_Gesture_No_Intend_Die, -X2.3_Gesture_Age_First, -X2.3_Gesture_Age_RecentorSingle, -X2.3_Gesture_specific, -X2.4_Had_Aborted_Attempt, -X2.4_Aborted_Attempt_Notes, -X2.4_Aborted_NumTimes, -X2.4_Aborted_NumTimes_Notes, -X2.4_DateofAborted_FirstTime, -X2.4_Aborted_Recent_age, -X2.4_DateofAborted_Recent, -X2.4_Aborted_ConfirmAborted, -X2.5_Interrupted, -X2.5_Interrupted_Notes, -X2.5_Interrupted_Notes, -X2.5_DateofInterrupted_FirstTime, -X2.5_DaysBetweenINT_First_and_Interview, -X2.5_Interrupted_Age_RecentorSingle, -X2.5_DateofInterrupted_RecentorSingle, -X2.5_Confirm_Interrupted, -X2.6_Attempt, -X2.6_Attempt_Age_First, -X2.6_Dateof_FirstAT, -X2.6_Days_From_FirstAT, -X2.6_RecentorSingle_AT, -X2.6_RecentorSingle_AT_date, -X2.6_Confirm_Attempt, -X2.6_Accuracy_first_time_age, -X4.1_WhatHappened, -X5_Method, -method_type1, -method_type2, -Num_Methods, -Num_Attempts_Prior_to_Admission, -Method_Other, -X5.4_How_Think_of_Method_ever, -Why_this_method, -Why_this_method_1_Peaceful.Neatness_2_Accessibility.Convenience_3_privacy_4_lethality, -X5.6_Thought_of_Pain, -X5.7_Thoughtof_OtherMethods, -Thought_of_other_Methods, -X5.8_Obtain_Method, -X5.10_Obtain_Method_Not.Sure_maybe_forsuicide, -X5.11_Obtain_Method_HowLong, -ObtainMethod_HowLong, -ObtainMethod_HowLong_Unit, -Obtain_Method_Date, -X5.12_Obtain_Method_When, -when_obtained_method) %>%
select(-X8.8_First_Action, -X8.9_First_Thing_Start, -Dec2Act_TimeUnit, -If.9.2.not.Sure..is.there.a.time.of.Sure..Yes...9.4..No...Seconds.before.attempt., -X9.2_When_decide_how_sure_would_attempt, -X9.4.Time.between.decision.and.attempt, -X10.1_prep, -X10.2_Prep_for_this_attempt, -X10.3.Prep..if.10.1.is.no., -X10.4_Num_Prep_Thoughts, -X10.5_Prep_Thoughts, -X10.6.Prep_Thoughts..if.10.4.is.no., -X11.1_Drugs_Before, -X11.2_HowLong, -X11.4_HowMuch_Before_Decision, -Quantity, -How_long_before_Time, -How_long_before_Time_Unit, -Drink_then_Decide, -Drink_Time, -Drink_Time_Unit, -X11.5_Decide_then_Drink, -X11.5_Decide_then_Drink_Quantity, -Decide_then_Drink_Time, -Decide_then_Drink_Time_Unit, -X12.1_Thoughts_About_Future, -Thoughts_Future_specific, -X12.2_1_positive_2_negative, -X12.3_Family_or_Friends, -Family_Friends_Specific, -FF_makesYou, -X12.4_Meaning_of_Death, -MeaningOfDeath_Specific, -MeaningOfDeath_MakeYou, -X12.5_AfterDeath_WhatWillHappen, -X12.6_What_Happens_After_Death, -WhatHappensAfter_MakeYou, -X12.7_PainBloodViolence, -PainBloodViolence_Specific, -PBV_MakeYou, -HowMuch_If_1_or_2, -X12.8_Reactions, -Reactions_Specific, -X12.10_Responsibilities, -Responsibilities_MakeYou, -Responsibilities_Specific, -X12.9_Dyingby_Suicide, -DieBySuicide_MakeYou, -X12.11.Why, -Circumstance.A, -Circumstance.B, -Circumstance.C, -Notes, -Notes.1, -X12.12.How.Long.A, -A.Time, -units, -How.Long.B, -B.Time, -units.1, -How.Long.C, -C.Time, -units.2, -Depr.for.Two.Weeks, -Injuries_SpecificDrug,-when_obtained_method_Unit, -Where_to_attempt, -X6.1_Where, -Ever_mulled, -NumMulling, -First_mulling_age, -Accuracy.of.first.mulling.age, -First_Thought_of.Method_1, -FirstThoughtof_Method_2, -First_Thoughtof_Method_2, -First_Thought_of.Method_1_Unit, -First_Thoughtof_Method_2_Unit, -First_Thought_of_Method_2_for_This_Attempt, -First_Thought_of_Method_2_for_This_Attempt_Unit, -X8.5_Mull_NoAct, -X8.6_Mull_NumTimes, -ABINT_Decision_StoppingTimeDiffuse, -Injuries_Rating)
# didn't code 103 & 105's age, adding them here
data <- data %>%
mutate(Age = ifelse(Subject == 103,ifelse(x_axis_Num == 1, 28, NA), Age),
Age = ifelse(Subject == 105, ifelse(x_axis_Num == 1, 32, NA),Age))
#```{r LifetimeSIdata}
data_lifetime <- data %>%
group_by(Subject) %>%
mutate(lifetimeSI_onset = min(Time_in_age),
lifetimeSI_duration = max(Time_prior_to_attempt),
lifetimeSI_range = max(Ideation_freq) - min(Ideation_freq),
lifetimeSI_mean = mean(Ideation_freq),
lifetimeSI_sd = sd(Ideation_freq)) %>%
filter(!is.na(Age))
#```
#```{r THOUGHTscoreDATA}
thought_score_data <- data_lifetime %>%
group_by(Subject) %>%
mutate(ff_score = ifelse(family_friends_makes_you == 1, thoughts_family_friends, thoughts_family_friends * -1),
meaning_score = ifelse(meaning_death_makes_you == 1, meaning_death, meaning_death * -1),
pain_score = ifelse(thoughts_pain_makes_you == 1, thoughts_pain, thoughts_pain *-1),
reactions_score = ifelse(reactions_makes_you == 1, thoughts_reactions, thoughts_reactions *-1),
responsibilities_score = ifelse(responsibilities_makes_you == 1, thoughts_responsibilities, thoughts_responsibilities * -1)) %>%
mutate(ff_score = ifelse(is.na(ff_score), 0, ff_score),
meaning_score = ifelse(is.na(meaning_score), 0, meaning_score),
pain_score = ifelse(is.na(pain_score), 0, pain_score),
reactions_score = ifelse(is.na(reactions_score), 0, reactions_score),
responsibilities_score = ifelse(is.na(responsibilities_score), 0, responsibilities_score),
thoughts_score = ff_score + meaning_score + pain_score + reactions_score + responsibilities_score) %>%
mutate(thoughts_amt = ifelse(thoughts_about_future == 1,
1 + thoughts_family_friends
+ meaning_death
+ thoughts_pain
+ thoughts_reactions
+ thoughts_responsibilities,
0 + thoughts_family_friends
+ meaning_death
+ thoughts_pain
+ thoughts_reactions
+ thoughts_responsibilities),
ff_score_want = ifelse(!is.na(family_friends_makes_you),
ifelse(family_friends_makes_you %in% c(1,3), thoughts_family_friends, 0), 0),
meaning_score_want = ifelse(!is.na(meaning_death_makes_you),
ifelse(meaning_death_makes_you %in% c(1,3), meaning_death, 0), 0),
pain_score_want = ifelse(!is.na(thoughts_pain_makes_you),
ifelse(thoughts_pain_makes_you %in% c(1,3), thoughts_pain, 0), 0),
reactions_score_want = ifelse(!is.na(reactions_makes_you),
ifelse(reactions_makes_you %in% c(1,3), thoughts_reactions, 0), 0),
responsibilities_score_want = ifelse(!is.na(responsibilities_makes_you),
ifelse(responsibilities_makes_you %in% c(1,3), thoughts_responsibilities, 0), 0),
thoughts_want = ff_score_want + meaning_score_want + pain_score_want + reactions_score_want + responsibilities_score_want,
ff_score_not_want = ifelse(!is.na(family_friends_makes_you),
ifelse(family_friends_makes_you %in% c(2,3), thoughts_family_friends, 0), 0),
meaning_score_not_want = ifelse(!is.na(meaning_death_makes_you),
ifelse(meaning_death_makes_you %in% c(2,3), meaning_death, 0), 0),
pain_score_not_want = ifelse(!is.na(thoughts_pain_makes_you),
ifelse(thoughts_pain_makes_you %in% c(2,3), thoughts_pain, 0), 0),
reactions_score_not_want = ifelse(!is.na(reactions_makes_you),
ifelse(reactions_makes_you %in% c(2,3), thoughts_reactions, 0), 0),
responsibilities_score_not_want = ifelse(!is.na(responsibilities_makes_you),
ifelse(responsibilities_makes_you %in% c(2,3), thoughts_responsibilities, 0), 0),
thoughts_not_want = ff_score_not_want + meaning_score_not_want + pain_score_not_want + reactions_score_not_want + responsibilities_score_not_want) %>%
select(-ff_score_want, -meaning_score_want, -pain_score_want, -reactions_score_want, -responsibilities_score_want,
-ff_score_not_want, -meaning_score_not_want, -pain_score_not_want, -reactions_score_not_want, -responsibilities_score_not_want,
-ff_score, -meaning_score, -pain_score, -reactions_score, -responsibilities_score) %>%
mutate(thoughts_score = ifelse(x_axis_Num != 1, NA, thoughts_score),
thoughts_amt = ifelse(x_axis_Num !=1, NA, thoughts_amt),
thoughts_want = ifelse(x_axis_Num != 1, NA, thoughts_want),
thoughts_not_want = ifelse(x_axis_Num != 1, NA, thoughts_not_want))
clean_data <- thought_score_data %>%
select(-thoughts_about_future, -thoughts_family_friends, -thoughts_pain, -thoughts_pain_makes_you, -thoughts_reactions, -thoughts_responsibilities, -thoughts_die_by_suicide, -meaning_death, -meaning_death_makes_you, -family_friends_makes_you, -reactions_makes_you, -responsibilities_makes_you, -y_axis)
#```
#```{r Bins}
data_transformedTime <- clean_data %>%
mutate(
ThoughtsStart_Seconds =
ifelse(Start_thinking.about_this_attempt_Time_Unit == "weeks",
Start_thinking.about_this_attempt_Time * 604800,
ifelse(Start_thinking.about_this_attempt_Time_Unit == "days",
Start_thinking.about_this_attempt_Time * 86400,
ifelse(Start_thinking.about_this_attempt_Time_Unit == "hours",
Start_thinking.about_this_attempt_Time * 3600,
ifelse(Start_thinking.about_this_attempt_Time_Unit == "minutes",
Start_thinking.about_this_attempt_Time * 60,
ifelse(Start_thinking.about_this_attempt_Time_Unit == "years",
Start_thinking.about_this_attempt_Time * 31536000,
ifelse(Start_thinking.about_this_attempt_Time_Unit == "months",
Start_thinking.about_this_attempt_Time*2592000,
Start_thinking.about_this_attempt_Time)))))),
MullingStarts_Seconds =
ifelse(Mulled_for_how_long_beforeAttempt_OR_atTheMostRecentMulling_Unit == "weeks",
Mulled_for_how_long_beforeAttempt_OR_atTheMostRecentMulling * 604800,
ifelse(Mulled_for_how_long_beforeAttempt_OR_atTheMostRecentMulling_Unit == "days",
Mulled_for_how_long_beforeAttempt_OR_atTheMostRecentMulling * 86400,
ifelse(Mulled_for_how_long_beforeAttempt_OR_atTheMostRecentMulling_Unit == "hours",
Mulled_for_how_long_beforeAttempt_OR_atTheMostRecentMulling * 3600,
ifelse(Mulled_for_how_long_beforeAttempt_OR_atTheMostRecentMulling_Unit == "minutes",
Mulled_for_how_long_beforeAttempt_OR_atTheMostRecentMulling * 60,
ifelse(Mulled_for_how_long_beforeAttempt_OR_atTheMostRecentMulling_Unit == "years",
Mulled_for_how_long_beforeAttempt_OR_atTheMostRecentMulling * 31536000,
ifelse(Mulled_for_how_long_beforeAttempt_OR_atTheMostRecentMulling_Unit == "months",
Mulled_for_how_long_beforeAttempt_OR_atTheMostRecentMulling * 2592000,
Mulled_for_how_long_beforeAttempt_OR_atTheMostRecentMulling)))))),
Decision_Seconds =
ifelse(Decision_time_Unit == "weeks",
Decision_time * 604800,
ifelse(Decision_time_Unit == "days",
Decision_time * 86400,
ifelse(Decision_time_Unit == "hours",
Decision_time * 3600,
ifelse(Decision_time_Unit == "minutes",
Decision_time * 60,
ifelse(Decision_time_Unit == "years",
Decision_time * 31536000,
ifelse(Decision_time_Unit == "months",
Decision_time * 2592000, Decision_time)))))),
FirstMethod_Seconds =
ifelse(First_think_of_method_1_for_this_attempt_Unit == "weeks",
First_think_of_method_1_for_this_attempt * 604800,
ifelse(First_think_of_method_1_for_this_attempt_Unit == "days",
First_think_of_method_1_for_this_attempt * 86400,
ifelse(First_think_of_method_1_for_this_attempt_Unit == "hours",
First_think_of_method_1_for_this_attempt * 3600,
ifelse(First_think_of_method_1_for_this_attempt_Unit == "minutes",
First_think_of_method_1_for_this_attempt * 60,
ifelse(First_think_of_method_1_for_this_attempt_Unit == "years",
First_think_of_method_1_for_this_attempt * 31536000,
ifelse(First_think_of_method_1_for_this_attempt_Unit == "months",
First_think_of_method_1_for_this_attempt * 2592000,
First_think_of_method_1_for_this_attempt)))))),
SureMethod_Seconds =
ifelse(Sure_of_Method_Unit == "weeks",
Sure_of_Method * 604800,
ifelse(Sure_of_Method_Unit == "days",
Sure_of_Method * 86400,
ifelse(Sure_of_Method_Unit == "hours",
Sure_of_Method * 3600,
ifelse(Sure_of_Method_Unit == "minutes",
Sure_of_Method * 60,
ifelse(Sure_of_Method_Unit == "years",
Sure_of_Method * 31536000,
ifelse(Sure_of_Method_Unit == "months",
Sure_of_Method * 2592000,
Sure_of_Method)))))),
FirstPlace_Seconds =
ifelse(X6.3_First_thinkof_place_for_this_attempt_Unit == "years",
X6.3_First_thinkof_place_for_this_attempt * 31536000,
ifelse(X6.3_First_thinkof_place_for_this_attempt_Unit == "months",
X6.3_First_thinkof_place_for_this_attempt * 2592000,
ifelse(X6.3_First_thinkof_place_for_this_attempt_Unit == "weeks",
X6.3_First_thinkof_place_for_this_attempt * 604800,
ifelse(X6.3_First_thinkof_place_for_this_attempt_Unit == "days",
X6.3_First_thinkof_place_for_this_attempt * 86400,
ifelse(X6.3_First_thinkof_place_for_this_attempt_Unit == "hours",
X6.3_First_thinkof_place_for_this_attempt * 3600,
ifelse(X6.3_First_thinkof_place_for_this_attempt_Unit == "minutes",
X6.3_First_thinkof_place_for_this_attempt * 60,
X6.3_First_thinkof_place_for_this_attempt)))))),
SurePlace_Seconds =
ifelse(FirstTime_sureof_place_for_This_Attempt_Unit == "years",
FirstTime_sureof_place_for_This_Attempt * 31536000,
ifelse(FirstTime_sureof_place_for_This_Attempt_Unit == "months",
FirstTime_sureof_place_for_This_Attempt * 2592000,
ifelse(FirstTime_sureof_place_for_This_Attempt_Unit == "weeks",
FirstTime_sureof_place_for_This_Attempt * 604800,
ifelse(FirstTime_sureof_place_for_This_Attempt_Unit == "days",
FirstTime_sureof_place_for_This_Attempt * 86400,
ifelse(FirstTime_sureof_place_for_This_Attempt_Unit == "hours",
FirstTime_sureof_place_for_This_Attempt * 3600,
ifelse(FirstTime_sureof_place_for_This_Attempt_Unit == "minutes",
FirstTime_sureof_place_for_This_Attempt * 60,
FirstTime_sureof_place_for_This_Attempt)))))))
#```
# ```{r Bins}
minute <- 60
hour <- 60*60
day <- 24*hour
three_day <- 3*day
week <- 7*day
two_week <- 14*day
month <- 30*day
six_month <- month*6
year <- 365*day
five_year <- 5*year
data_bins <- data_transformedTime %>%
mutate(
Mull_bin =
ifelse(MullingStarts_Seconds <= minute, 1,
ifelse(MullingStarts_Seconds <= minute*5, 2,
ifelse(MullingStarts_Seconds <= minute*15, 3,
ifelse(MullingStarts_Seconds <= minute*30, 4,
ifelse(MullingStarts_Seconds <= hour, 5,
ifelse(MullingStarts_Seconds <= hour*2, 6,
ifelse(MullingStarts_Seconds <= hour*3, 7,
ifelse(MullingStarts_Seconds <= hour*6, 8,
ifelse(MullingStarts_Seconds <= hour*12, 9,
ifelse(MullingStarts_Seconds <= day, 10,
ifelse(MullingStarts_Seconds <= day*3, 11,
ifelse(MullingStarts_Seconds <= week, 12,
ifelse(MullingStarts_Seconds <= two_week, 13,
ifelse(MullingStarts_Seconds <= month, 14,
ifelse(MullingStarts_Seconds <= six_month, 15,
ifelse(MullingStarts_Seconds <= year, 16,
ifelse(MullingStarts_Seconds <= five_year, 1, 17))))))))))))))))),
ThoughtsStart_bin =
ifelse(ThoughtsStart_Seconds <= minute, 1,
ifelse(ThoughtsStart_Seconds <= minute*5, 2,
ifelse(ThoughtsStart_Seconds <= minute*15, 3,
ifelse(ThoughtsStart_Seconds <= minute*30, 4,
ifelse(ThoughtsStart_Seconds <= hour, 5,
ifelse(ThoughtsStart_Seconds <= hour*2, 6,
ifelse(ThoughtsStart_Seconds <= hour*3, 7,
ifelse(ThoughtsStart_Seconds <= hour*6, 8,
ifelse(ThoughtsStart_Seconds <= hour*12, 9,
ifelse(ThoughtsStart_Seconds <= day, 10,
ifelse(ThoughtsStart_Seconds <= day*3, 11,
ifelse(ThoughtsStart_Seconds <= week, 12,
ifelse(ThoughtsStart_Seconds <= two_week, 13,
ifelse(ThoughtsStart_Seconds <= month, 14,
ifelse(ThoughtsStart_Seconds <= six_month, 15,
ifelse(ThoughtsStart_Seconds <= year, 16,
ifelse(ThoughtsStart_Seconds <= five_year, 1, 17))))))))))))))))),
Decision_bin =
ifelse(Decision_Seconds <= minute, 1,
ifelse(Decision_Seconds <= minute*5, 2,
ifelse(Decision_Seconds <= minute*15, 3,
ifelse(Decision_Seconds <= minute*30, 4,
ifelse(Decision_Seconds <= hour, 5,
ifelse(Decision_Seconds <= hour*2, 6,
ifelse(Decision_Seconds <= hour*3, 7,
ifelse(Decision_Seconds <= hour*6, 8,
ifelse(Decision_Seconds <= hour*12, 9,
ifelse(Decision_Seconds <= day, 10,
ifelse(Decision_Seconds <= day*3, 11,
ifelse(Decision_Seconds <= week, 12,
ifelse(Decision_Seconds <= two_week, 13,
ifelse(Decision_Seconds <= month, 14,
ifelse(Decision_Seconds <= six_month, 15,
ifelse(Decision_Seconds <= year, 16,
ifelse(Decision_Seconds <= five_year, 1, 17))))))))))))))))),
FstMethod_bin =
ifelse(FirstMethod_Seconds <= minute, 1,
ifelse(FirstMethod_Seconds <= minute*5, 2,
ifelse(FirstMethod_Seconds <= minute*15, 3,
ifelse(FirstMethod_Seconds <= minute*30, 4,
ifelse(FirstMethod_Seconds <= hour, 5,
ifelse(FirstMethod_Seconds <= hour*2, 6,
ifelse(FirstMethod_Seconds <= hour*3, 7,
ifelse(FirstMethod_Seconds <= hour*6, 8,
ifelse(FirstMethod_Seconds <= hour*12, 9,
ifelse(FirstMethod_Seconds <= day, 10,
ifelse(FirstMethod_Seconds <= day*3, 11,
ifelse(FirstMethod_Seconds <= week, 12,
ifelse(FirstMethod_Seconds <= two_week, 13,
ifelse(FirstMethod_Seconds <= month, 14,
ifelse(FirstMethod_Seconds <= six_month, 15,
ifelse(FirstMethod_Seconds <= year, 16,
ifelse(FirstMethod_Seconds <= five_year, 1, 17))))))))))))))))),
FstPlace_bin =
ifelse(FirstPlace_Seconds <= minute, 1,
ifelse(FirstPlace_Seconds <= minute*5, 2,
ifelse(FirstPlace_Seconds <= minute*15,3,
ifelse(FirstPlace_Seconds <= minute*30, 4,
ifelse(FirstPlace_Seconds <= hour, 5,
ifelse(FirstPlace_Seconds <= hour*2, 6,
ifelse(FirstPlace_Seconds <= hour*3, 7,
ifelse(FirstPlace_Seconds <= hour*6, 8,
ifelse(FirstPlace_Seconds <= hour*12, 9,
ifelse(FirstPlace_Seconds <= day, 10,
ifelse(FirstPlace_Seconds <= day*3, 11,
ifelse(FirstPlace_Seconds <= week, 12,
ifelse(FirstPlace_Seconds <= two_week, 13,
ifelse(FirstPlace_Seconds <= month, 14,
ifelse(FirstPlace_Seconds <= six_month, 15,
ifelse(FirstPlace_Seconds <= year, 16,
ifelse(FirstPlace_Seconds <= five_year, 1, 17))))))))))))))))),
SureMethod_bin =
ifelse(SureMethod_Seconds <= minute, 1,
ifelse(SureMethod_Seconds <= minute*5, 2,
ifelse(SureMethod_Seconds <= minute*15, 3,
ifelse(SureMethod_Seconds <= minute*30, 4,
ifelse(SureMethod_Seconds <= hour, 5,
ifelse(SureMethod_Seconds <= hour*2, 6,
ifelse(SureMethod_Seconds <= hour*3, 7,
ifelse(SureMethod_Seconds <= hour*6, 8,
ifelse(SureMethod_Seconds <= hour*12, 9,
ifelse(SureMethod_Seconds <= day, 10,
ifelse(SureMethod_Seconds <= day*3, 11,
ifelse(SureMethod_Seconds <= week, 12,
ifelse(SureMethod_Seconds <= two_week, 13,
ifelse(SureMethod_Seconds <= month, 14,
ifelse(SureMethod_Seconds <= six_month, 15,
ifelse(SureMethod_Seconds <= year, 16,
ifelse(SureMethod_Seconds <= five_year, 1, 17))))))))))))))))),
SurePlace_bin =
ifelse(SurePlace_Seconds <= minute, 1,
ifelse(SurePlace_Seconds <= minute*5, 2,
ifelse(SurePlace_Seconds <= minute*15, 3,
ifelse(SurePlace_Seconds <= minute*30, 4,
ifelse(SurePlace_Seconds <= hour, 5,
ifelse(SurePlace_Seconds <= hour*2, 6,
ifelse(SurePlace_Seconds <= hour*3, 7,
ifelse(SurePlace_Seconds <= hour*6, 8,
ifelse(SurePlace_Seconds <= hour*12, 9,
ifelse(SurePlace_Seconds <= day, 10,
ifelse(SurePlace_Seconds <= day*3, 11,
ifelse(SurePlace_Seconds <= week, 12,
ifelse(SurePlace_Seconds <= two_week, 13,
ifelse(SurePlace_Seconds <= month, 14,
ifelse(SurePlace_Seconds <= six_month, 15,
ifelse(SurePlace_Seconds <= year, 16,
ifelse(SurePlace_Seconds <= five_year, 1, 17))))))))))))))))))
data_totalPthwy <- data_bins %>%
mutate(researched = ifelse(Research_1_YES_2_NO_3_InPast_4_YES_but_not_on_Method != 2, 1, 0),
obtainedMethod = ifelse(X5.9_Obtain_Method_Sure_useforsuicide == 1, 1, 0),
drank_before_after = ifelse(X11.3_Decide_before_or_after != 1, ifelse(X11.3_Decide_before_or_after == "Both", 1, 0), 1),
NumPrep_Total = ifelse(!is.na(NumPrep),
ifelse(!is.na(researched),
ifelse(!is.na(obtainedMethod),
ifelse(!is.na(drank_before_after),
NumPrep+researched+obtainedMethod+drank_before_after,
NumPrep+researched+obtainedMethod),
ifelse(!is.na(drank_before_after),
NumPrep+researched+drank_before_after)),
ifelse(!is.na(obtainedMethod),
ifelse(!is.na(drank_before_after),
NumPrep+obtainedMethod+drank_before_after,
NumPrep+obtainedMethod),
ifelse(!is.na(drank_before_after),
NumPrep+drank_before_after,
NumPrep))),
ifelse(!is.na(researched),
ifelse(!is.na(obtainedMethod),
ifelse(!is.na(drank_before_after),
researched+obtainedMethod+drank_before_after,
researched+obtainedMethod),
ifelse(!is.na(drank_before_after),
researched+drank_before_after,
researched)),
ifelse(!is.na(obtainedMethod),
ifelse(!is.na(drank_before_after),
obtainedMethod+drank_before_after,
obtainedMethod),
ifelse(!is.na(drank_before_after),
drank_before_after, NA)))),
TotalPthwy_Max = max(Mull_bin, Decision_bin, SurePlace_bin, SureMethod_bin, ThoughtsStart_bin, FstPlace_bin, FstMethod_bin))
data_totalPthwy$Pthwy_mean = rowMeans(subset(data_totalPthwy, select = c(Mull_bin, Decision_bin, SurePlace_bin, SureMethod_bin, ThoughtsStart_bin, FstPlace_bin, FstMethod_bin)), na.rm = TRUE)
data_totalPthwy <- data_totalPthwy %>%
mutate(TotalpthwyMean = ifelse(!is.na(NumPrep_Total),
ifelse(!is.na(TotalPthwy_Max),
Pthwy_mean + TotalPthwy_Max * 0.5 + NumPrep_Total,
NumPrep_Total + Pthwy_mean),
ifelse(!is.na(TotalPthwy_Max),
TotalPthwy_Max * 0.5 + Pthwy_mean,
Pthwy_mean)))
cal_func <- function(x, y) {
m1 <- lm(y ~ x, data_new)
summary(m1)
}
at <- c("2","4","9","10","12","13","14","15","27","28","33","35","41","43","44","45","46","48","50","52","57","59","61","62","63","64","65","66","68","103", "105")
ab <- c("5","6","7","39","11","16","19","21","22","24","25","29","30","31","35","37","38","39","42","49","56","60")
int <- c("1","55")
abint <- c("5","6","7","39","11","16","19","21","22","24","25","29","30","31","35","37","38","39","42","49","56","60","1","55")
female <- c("2","4","5","6","7","8","9","11","12","13","17","19","21","22","23","24","25","27","28","31","34","36","37","38","40","41","43","44","45", "48", "49","50","53","54","58","59","64","65","69")
## Note: Subject 35 doesn't remember the details of their aborted attempt over a year ago therefore belong to ID group which is not involved in this study.
asian <- c("6","13","28","59")
af_am <- c("15")
caucasian <- c("2","4","5","7","9","10", "11","12","14","16","19","21","22","24","25","27","29","30","31","33","37","38","43","44","45","46","48","49","50","52","56","57","60","61","62","63","64","65","66","68")
mix <- c("1","39","41","42","55")
data_combinedBins <- data_totalPthwy %>%
mutate(think_mull_decide = ThoughtsStart_bin + Mull_bin + Decision_bin,
first_sure_method = FstMethod_bin + SureMethod_bin,
first_sure_place = FstPlace_bin + SurePlace_bin,
decide_method_place = Decision_bin + SureMethod_bin + SurePlace_bin,
all_bins = think_mull_decide + first_sure_method + first_sure_place,
race = ifelse(Subject %in% asian, "Asian",
ifelse(Subject %in% af_am, "African American",
ifelse(Subject %in% caucasian, "Caucasian",
ifelse(Subject %in% mix, "Mixed", NA)))))
data_new <- data_combinedBins %>%
mutate(group = as.factor(ifelse(Subject %in% at, "at", ifelse(Subject %in% abint, "ab/int", NA))),
sex = as.factor(ifelse(Subject %in% female, "F", "M")),
whether_planned_f = as.factor(X1.2_Ever_made_a_plan),
whether_mulled_f = as.factor(X8.3_Mulled_for_this_attempt),
dpr_f = as.factor(dpr_2_wk),
X2.6_Confirm_suicide_intent = ifelse(X2.6_Confirm_suicide_intent == 3, 2, X2.6_Confirm_suicide_intent),
suicide_intent_f = as.factor(X2.6_Confirm_suicide_intent),
sis_1 = SIS_15_HowMuchPlan,
sis_2 = sis_1 + SIS_6_Planning,
sis_3 = sis_2 + SIS_7_WriteAnything,
sis_7 = SIS_1_AnyoneNearby+SIS_2_HowLikelyDiscovery+SIS_3_AvoidDiscovery+SIS_5_Preparations,
sis_8 = sis_7 + SIS_8_WhoDidYouTell,
sis_15 = SIS_1_AnyoneNearby+SIS_2_HowLikelyDiscovery+SIS_3_AvoidDiscovery+SIS_4_ContactHelper+SIS_5_Preparations+SIS_6_Planning+SIS_7_WriteAnything+SIS_8_WhoDidYouTell+SIS_9_Why+SIS_10_ThinkDie+SIS_11_ConfidenceDeath+SIS_12_HowSerious+SIS_13_HowCertainWantDie+SIS_14_CouldDoctorHelp+SIS_15_HowMuchPlan,
pthwy_thoughts_amt = TotalpthwyMean*thoughts_amt,
pthwy_thoughts_push = TotalpthwyMean*thoughts_want,
pthwy_thoughts_pull = TotalpthwyMean*thoughts_not_want,
pthwy_thoughts_counbal = TotalpthwyMean*thoughts_score,
perceived_lethality = ifelse(as.character(X12.17_Method_Perceived_Lethality) == "4- dehydration", "4", as.character(X12.17_Method_Perceived_Lethality)),
perceived_lethality = as.numeric(perceived_lethality),
nssi_duration = Age-X2.2_NSSI_Age_FirstTime,
nssi_onset = X2.2_NSSI_Age_FirstTime,
nssi_times = as.double(ifelse(X2.2_NSSI_NumTimes_FINAL == "25-50", "37.5",
ifelse(X2.2_NSSI_NumTimes_FINAL == "50-75", "62.5",
ifelse(X2.2_NSSI_NumTimes_FINAL == "5-10", "7.5",
ifelse(X2.2_NSSI_NumTimes_FINAL == "1-5", "2.5",
ifelse(X2.2_NSSI_NumTimes_FINAL == "11-25", "18",
ifelse(X2.2_NSSI_NumTimes_FINAL == "50-100", "75",
ifelse(X2.2_NSSI_NumTimes_FINAL == "1", "1", NA)))))))),
nssi_freq = nssi_times/ifelse(nssi_duration == 0, NA, nssi_duration),
aborted_onset = X2.4_Aborted_First_Age,
aborted_duration = X2.4_Aborted_Recent_ageFinal - aborted_onset,
aborted_freq = X2.4_Aborted_Num_Times_FINAL/ifelse(aborted_duration == 0, NA, aborted_duration),
realize_not_dead = ifelse(X12.16_Realized_Not_Dead == "4- physical relief 3- partly upset for not completing", "3.5",
ifelse(X12.16_Realized_Not_Dead == "3-anxious", "3",
ifelse(X12.16_Realized_Not_Dead == "2->4 (cluster)","3",
ifelse(X12.16_Realized_Not_Dead == "pretty disappointed", "4", as.character(X12.16_Realized_Not_Dead))))),
realize_not_dead = as.numeric(realize_not_dead),
first_int_age = ifelse(!is.na(X2.5_Interrupted_Age_First), X2.5_Interrupted_Age_First, X2.5_Age_RecentorSingle),
first_action_age = X2.6_First_AT_age,
first_action_age = ifelse(is.na(first_action_age), first_int_age, first_action_age),
first_action_age = ifelse(is.na(first_action_age), X2.4_Aborted_First_Age, ifelse(first_action_age<=X2.4_Aborted_First_Age, first_action_age, X2.4_Aborted_First_Age)),
ideation_onset = X2.9.1_Age_FirstTime_Should_Kill,
at_duration = X2.6_RecentorSingle_AT_age - X2.6_First_AT_age,
FirstID_to_FirstAction = first_action_age - X2.9.1_Age_FirstTime_Should_Kill
) %>%
select(-X2.5_Interrupted_NumTimes_Notes,-X5.1_FirstTime_ThoughtofMethod,-X5.2_First_Thoughtof_Method_for_this_attempt,-X5.3_Time_SureofMethod,-First_think_of_method_1_for_this_attempt,-First_think_of_method_1_for_this_attempt_Unit,-Interrupt.Abort_FirstTime_ThoughtofAnyMethodEver....,-Sure_of_Method,-Sure_of_Method_Unit,-X6.2_when_first_thoughtof_place,-X6.2_when_first_thoughtof_place_Unit,-X6.3_First_thinkof_place_for_this_attempt,-X6.4_First_time_sure_place_for_this_attempt,-X6.3_First_thinkof_place_for_this_attempt_Unit,-FirstTime_sureof_place_for_This_Attempt,-FirstTime_sureof_place_for_This_Attempt_Unit,-X6.7_Suicide_Intent_When,-X6.8_Travel_HowLong,-X7_Time,-X7.2_When_decided_the_time,-X7.3_How_sure_about_planned_time,-X8.1_Think_about_for_this_attempt,-Mulled_for_how_long_beforeAttempt_OR_atTheMostRecentMulling,-Mulled_for_how_long_beforeAttempt_OR_atTheMostRecentMulling_Unit,-Start_thinking_about_this_attempt,-Start_thinking.about_this_attempt_Time,-Start_thinking.about_this_attempt_Time_Unit,-X8.4_Start_mulling_for_this_attempt,-most_recent_mulling_to_interview,-most_recent_mulling_to_interview_Unit,-X8.8_When_Decision,-X12.16_Realized_Not_Dead,-X12.17_Method_Perceived_Lethality,-X2.2_NSSI_NumTimes_FINAL,-Dep_2_weeks)
write_csv(data_new, "./Data/SecondStep_most_up_to_date.csv")
